
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./todo_logo.png" type="image/png" />
    <link rel="stylesheet" href="style.css" />
    <title>todo</title>
  </head>
  <body>
    <input id="input" type="text" placeholder="Enter your task" />
    <button id="add">Add</button>
    <ul id="list"></ul>
    <button id="theme">🔆</button>
    <button id="completed_tasks_btn">completed tasks</button>
    <button id="readme_link">readme</button>
    <button id="btn_work">work</button>

    <script>
      // to everyone who reads this, the comments I leave below were made for me,
      // if I had forgotten how the code works, so I don't advise you to read them
      // всем кто это читает, коментарие которые я оставляю ниже были сделаны
      // для меня, если бы я забыл как работает код, так что читать их я вам не советую
      // 0
      let input = document.getElementById("input");
      let add = document.getElementById("add");
      let list = document.getElementById("list");
      //1
      let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
      function render_tasks() {
        list.innerHTML = "";
        tasks.forEach((task, index) => {
          const li = document.createElement("li");
          li.className = "li";
          li.textContent = task;

          // 2  button of delete
          const delete_btn = document.createElement("input");
          delete_btn.type = "checkbox";
          delete_btn.className = "check";
          delete_btn.onclick = () => {
            li.style.textDecoration = delete_btn.checked // те li у которых активен checkbox зачеркнуть
              ? // или если по другому, если checkbox у li true то сделать первое действие, если false то второе
                "line-through"
              : "none";
            setTimeout(() => {
              let completed_tasks_array =
                JSON.parse(localStorage.getItem("completed_tasks")) || [];
              completed_tasks_array.push(task);
              localStorage.setItem(
                "completed_tasks",
                JSON.stringify(completed_tasks_array)
              );
              tasks.splice(index, 1);
              saveTasks();
            }, 800);

            // 3 добавить в поток
          };
          //color: rgb(138, 213, 0);color: rgb(92, 136, 8); mb
          const arrow_up = document.createElement("button");
          arrow_up.textContent = " ⇧";
          arrow_up.className = "btns_up_down";
          arrow_up.addEventListener("click", () => {
            if (index > 0) {
              [tasks[index - 1], tasks[index]] = [
                tasks[index],
                tasks[index - 1],
              ];
              saveTasks();
            }
          });
          const arrow_down = document.createElement("button");
          arrow_down.textContent = "⇩";
          arrow_down.className = "btns_up_down";
          arrow_down.addEventListener("click", () => {
            if (index < tasks.length - 1) {
              [tasks[index], tasks[index + 1]] = [
                tasks[index + 1],
                tasks[index],
              ];
              saveTasks();
            }
          });
          li.appendChild(arrow_up);
          li.appendChild(arrow_down);

          li.appendChild(delete_btn);
          list.appendChild(li);
        });
      }
      // 4 сохранить, в localStorage путем пересоздая
      function saveTasks() {
        localStorage.setItem("tasks", JSON.stringify(tasks));
        render_tasks();
      } //5 функция которая добавляет значение из input в tasks
      function push_to_tasks() {
        if (input.value.trim() !== "") {
          tasks.push(input.value);
          input.value = "";
          saveTasks();
        }
      }
      //5.1 добавить из значения из input
      add.addEventListener("click", () => {
        push_to_tasks();
      });
      // 5.2
      input.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          event.preventDefault();
          push_to_tasks();
        }
      });
      // 6 При загрузке страницы встатавить значения
      render_tasks();
      // 7 кнопка которая видет на страницу с текстом README
      let readme = document.getElementById("readme_link");
      readme.addEventListener("mousedown", () => {
        readme.style.bottom = "17px";
      });
      // анимация нажатия кнопки
      document.addEventListener("mouseup", () => {
        readme.style.bottom = "20px";
      });

      readme.addEventListener("click", () => {
        window.location.href = "read.html";
      });
      let completed_tasks = document.getElementById("completed_tasks_btn");
      completed_tasks.addEventListener("mousedown", () => {
        completed_tasks.style.bottom = "17px";
      });
      document.addEventListener("mouseup", () => {
        completed_tasks.style.bottom = "20px";
      });
      completed_tasks.addEventListener("click", () => {
        window.location.href = "completed_tasks.html";
      });
      let last_theme_local = localStorage.getItem("last_theme");
      let last_theme = "🌙";

      let theme = document.getElementById("theme");
      if (last_theme_local === "🔆") {
        document.body.style.backgroundColor = "aliceblue";
        document.body.style.color = "black";
        theme.textContent = "🌙";
      } else if (last_theme_local === "🌙") {
        document.body.style.color = "aliceblue";
        document.body.style.backgroundColor = "rgb(33, 30, 30)";
        input.style.backgroundColor = "";
        input.style.color = "";
        add.style.backgroundColor = "";
        add.style.color = "";
      }
      theme.addEventListener("click", () => {
        if (theme.textContent === "🔆") {
          theme.textContent = "🌙";
          document.body.style.backgroundColor = "aliceblue";
          document.body.style.color = "black";
          //input.style.backgroundColor = "rgb(33, 30, 30)";
          //input.style.color = "aliceblue";
          //add.style.backgroundColor = "rgb(33, 30, 30)";
          //add.style.color = "aliceblue";
          let last_theme = "🔆";
          localStorage.setItem("last_theme", last_theme);
        } else if (theme.textContent === "🌙") {
          theme.textContent = "🔆";
          document.body.style.color = "aliceblue";
          document.body.style.backgroundColor = "rgb(33, 30, 30)";
          input.style.backgroundColor = "";
          input.style.color = "";
          add.style.backgroundColor = "";
          add.style.color = "";
          let last_theme = "🌙";
          localStorage.setItem("last_theme", last_theme);
        }
      });
      let btn_work = document.getElementById("btn_work");
      btn_work.addEventListener("mousedown", () => {
        btn_work.style.bottom = "17px";
      });
      document.addEventListener("mouseup", () => {
        btn_work.style.bottom = "20px";
      });
      btn_work.addEventListener("click", () => {
        window.location.href = "work.html";
      });
    </script>
  </body>
</html>
